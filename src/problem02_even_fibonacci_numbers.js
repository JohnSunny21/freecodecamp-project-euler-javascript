/**
 * Problem 2: Even Fibonacci Numbers
 *
 * Each new term in the Fibonacci sequence is generated by adding the previous two terms. By starting with 1 and 2, the first 10 terms will be:
 * 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, ...
 * By considering the terms in the Fibonacci sequence whose values do not exceed n, find the sum of the even-valued terms.
 * 
 * 
 */

/* =========================================================
 * âŒ INITIAL (INCORRECT / SUBOPTIMAL) APPROACH
 * =========================================================
 * 
 * this was my first attempt while learning.
 * It is intentionally kept here to document:
 * - Incorrect interpretation of the problem
 * - Inefficient memory usage.
 * - Poor loop boundaries.
 * 
 * Issues in this approach:
 * 1. Misinterpreted n as the number of terms instead of a max value.
 * 2. Stored the entire Fibonacci sequence unneccessarily.
 * 3. Used two loops where one would suffice.
 * 4> Does not scale for large inputs (e.g., n = 4_000_000).
 * 
 */




function fiboEvenSum_incorrect(n) {
  let fiboSeries = [1, 2];
  let sum = 0;
  for (let i = 0; i < n; i++){
    if(fiboSeries.length == n){
      break;
    }else{
        fiboSeries.push(fiboSeries[i] + fiboSeries[i+1]);
    }
    
  }
  console.log(fiboSeries.length);
  console.log(fiboSeries);


for(const item of fiboSeries){
    if(item % 2 === 0 && item <= n){
        sum += item;
    }
}
  return sum;
}


/* =========================================================
 * âœ… CORRECT ITERATIVE APPROACH (PRODUCTION-READY)
 * =========================================================
 * 
 * Approach:
 * - Generate Fibonacci numbers iteratively.
 * - Stop when the value exceeds the limit.
 * - Track only the last two numbers (O(1) space).
 * - Accumulate even-valued terms during generation.
 * 
 * Time Complexity: O(k) , where k is the number of Fibonacci terms
 * Space Complexity: O(1)
*/

function sumEvenFibonacci(limit) {
    if (limit < 2) return 0;

    let prev = 1;
    let curr = 2;
    let sum = 2;    // 2 is even and within the limit

    while(true){
        const next = prev + curr;
        if(next > limit){
            break;
        }
        if(next % 2 === 0){
            sum += next;
        }

        prev = curr;
        curr = next;
    }

    return sum;

}


/*=========================================================
 * ðŸš€ OPTIMIZED MATHEMATICAL APPROACH (SENIOR-LEVEL)
 * =========================================================
 *
 * Insight:
 * - Every 3rd Fibonacci number is even.
 * - Even Fibonacci numbers follow the recurrence:
 * 
 *  E(n) = 4 * E(n - 1) + E(n - 2)
 * 
 * This allows us to skip odd terms entirely.
 * 
 * Time Complexity: O(log n)
 * Space Complexity: O(1)
 */


function sumEvenFibonacciOptimized(limit){
    let sum = 0;
    let a = 2; // First even Fibonacci number
    let b = 8; // Second even Fibonacci number

    while( a <= limit){
        sum += a;
        const next = 4 * b + a;
        a = b;
        b = next;
    }

    return sum;
}


/* =========================================================
 * â–¶ï¸ EXECUTION / VERIFICATION
 * =========================================================
 */
console.log(sumEvenFibonacci(10));               // 10
console.log(sumEvenFibonacci(4000000));          // 4613732

console.log(sumEvenFibonacciOptimized(10));      // 10
console.log(sumEvenFibonacciOptimized(4000000)); // 4613732